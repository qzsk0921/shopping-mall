<!--pages/shopping/shopping.wxml-->
<!-- <text>pages/shopping/shopping.wxml</text> -->
<view class="container container-shopping">
  <view class="fixed">
    <top-navigation navigationBarTitleText="{{navigationBarTitleText}}" navHeight="{{compatibleInfo.navHeight}}" navTop="{{compatibleInfo.menuButtonObject.top}}" menuButtonHeight="{{compatibleInfo.menuButtonObject.height}}" status="{{navStatus}}" color="#333" bgColor="#fff" />
  </view>
  <!-- 购物券 -->
  <view class="coupon" bindtap="couponHandle">
    <view class="left">
      <image class="icon-coupon" src="/assets/images/car_icon_coupons.png" mode="aspectFill"></image>
      <text>我的优惠券（共{{couponLen}}张）</text>
    </view>
    <view class="right">
      <text>{{couponLen?'去看看':'去领券'}}</text>
      <view class="arrow"></view>
    </view>
  </view>
  <scroll-view class="scroll-box item-box" refresher-enabled="{{refresherEnabled}}" refresher-triggered="{{triggered}}" bindscrolltolower="scrollToLower" bindrefresherrefresh="scrollToRefresherrefresh" bindrefresherpulling="scrollToRefresherPull" bindrefresherrestore="scrollToRefresherStore" bindrefresherabort="scrollToRefresherAbort" scroll-y="true" enhanced="true" show-scrollbar="{{false}}" style="height:{{compatibleInfo.isIphoneX?compatibleInfo.systemInfo.screenHeight-(fixed+32)+'px':compatibleInfo.systemInfo.screenHeight-(fixed)+'px'}};" style="height:{{compatibleInfo.isIphoneX?compatibleInfo.systemInfo.screenHeight-(50+32+scrollBoxH)+'px':compatibleInfo.systemInfo.screenHeight-(50+scrollBoxH)+'px'}}">
    <!--这里是下拉显示的效果-->
    <view slot="refresher" class="refresh-container disf faic" style="display:block;width: 100%; height: 80px;  display: flex; align-items:center;justify-content:center;box-sizing: border-box;border-bottom:1px solid #f5f5f5"></view>
    <view class="no-data" wx:if="{{(cartList.cache.length==0)}}">
      <image mode="aspectFill" src="/assets/images/empty.png"></image>
      <view class="text">暂无更多内容</view>
    </view>
    <view class="content" wx:elif="{{cartList.cache.length}}">
      <view class="section2">
        <checkbox-group bindchange="checkboxChange">
          <view class="item {{item.status===2?'mask-box':item.store?'':'mask-box'}}" wx:for="{{cartList.cache}}" wx:key="unique" data-disabled="{{item.status===2?0:item.store?1:0}}">
            <!-- 关闭按钮 -->
            <image class="btn-close" src="/assets/images/car_icon_del.png" mode="aspectFill" bindtap="delGoodsHandle">
            </image>
            <!-- <view class="btn-close"></view> -->
            <!-- 选择商品数量 -->
            <view class="goods-quantity-control" data-disabled="{{item.status===2?0:item.store?1:0}}">
              <view class="tip">达最大数量</view>
              <image class="reduce" src="/assets/images/car_icon_reduce.png" mode="aspectFill"></image>
              <input class="quantity" type="number" value="1" bindblur="quantityBlurHandle" />
              <image class="add" src="/assets/images/car_icon_add.png" mode="aspectFill"></image>
            </view>
            <view class="left">
              <view class="checkbox-box">
                <checkbox value="{{item.name}}" checked="{{item.checked}}" />
              </view>
            </view>
            <view class="center">
              <view class="icon-goods-box">
                <view class="mask">{{item.status===2?'已下架':item.store?'':'库存不足'}}</view>
                <image class="icon-goods" src="{{item.thumb}}" mode="aspectFill"></image>
              </view>
            </view>
            <view class="right">
              <!-- <view class="l1">
              <view class="tag">预售专区</view><text>{{item.option}}</text>
            </view>
            <view class="l3">{{item.spec}}</view> -->

              <view class="l1">
                <view wx:if="{{item.is_pre_sale===1 || item.activity_info.activity_name}}" class="tag {{item.is_pre_sale===1?'pre_sale':item.activity_info.activity_name?'new_activity':''}}">{{item.is_pre_sale===1?'预售专区':item.activity_info.activity_name?'新品上市':''}}</view>
                {{item.goods_name}} {{item.spec}}
              </view>
              <!-- <view class="l4">
              <text>￥</text><text>{{item.price}}</text>
              <text>￥{{item.originPrice}}</text>
            </view> -->

              <!-- 未授权或未资质认证的非会员 -->
              <view class="l4 no-sign" wx:if="{{!userInfo.phone||userInfo.is_shop_check!=1}}">
                请登录查看价格
              </view>
              <!-- 授权且资质认证的非会员 -->
              <view class="l4" wx:elif="{{!userInfo.is_vip}}">
                <view class="price">
                  <text>￥</text>{{itemName.market_price}}
                </view>
              </view>
              <!-- 授权且资质认证的会员 -->
              <view class="l4" wx:else>
                <view class="price">
                  <text>￥</text>{{itemName.price}}
                </view>
                <view class="origin-price">￥{{itemName.market_price}}</view>
              </view>
            </view>
          </view>
        </checkbox-group>
      </view>
    </view>
    <view class="bottom">
      <view class="select-box">
        <checkbox value="all" bindtap="selectall" />全选
      </view>
      <view class="amount-box">
        <view class="left">
          <view class="left-t"><text>总计</text> <text class="price">￥55.12</text></view>
          <view class="left-b">已优惠8.88</view>
        </view>
        <view class="right">
          <view class="btn btn-pay" bindtap="payHandle">结算(5)</view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>

<confirm dialogVisible="{{confirmDialogVisibile}}" bindconfirm="diaConfirmHandle" bindcancel="diaCancelHandle" content="{{confirmContent}}" title="{{confirmTitle}}" confirmBgColor="{{confirmBgColor}}" />